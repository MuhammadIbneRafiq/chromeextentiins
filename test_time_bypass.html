<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time-Based Bypass Test Suite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .test-section h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .test-case {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }
        
        .test-case.pass {
            border-color: #4caf50;
            background: #f1f8f4;
        }
        
        .test-case.fail {
            border-color: #f44336;
            background: #fef1f0;
        }
        
        .test-case.running {
            border-color: #ff9800;
            background: #fff8f0;
        }
        
        .test-name {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .test-result {
            font-size: 0.95em;
            color: #666;
            margin-top: 10px;
        }
        
        .test-details {
            background: #fff;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .status-badge.pass {
            background: #4caf50;
            color: white;
        }
        
        .status-badge.fail {
            background: #f44336;
            color: white;
        }
        
        .status-badge.running {
            background: #ff9800;
            color: white;
        }
        
        .status-badge.pending {
            background: #9e9e9e;
            color: white;
        }
        
        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .time-simulator {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #ffc107;
        }
        
        .time-simulator h3 {
            color: #856404;
            margin-bottom: 15px;
        }
        
        .time-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .time-input input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            width: 100px;
        }
        
        .time-input label {
            font-weight: bold;
            color: #856404;
        }
        
        .current-time {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 2px solid #667eea;
        }
        
        .current-time strong {
            color: #667eea;
        }
        
        .summary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
        }
        
        .summary h2 {
            color: white;
            margin-bottom: 20px;
        }
        
        .summary-stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-number {
            font-size: 3em;
            font-weight: bold;
            display: block;
        }
        
        .stat-label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .icon {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        .test-url {
            background: #e3f2fd;
            padding: 8px 12px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-top: 5px;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üïí Time-Based Bypass Test Suite</h1>
        <p class="subtitle">Amsterdam Time Window: 3:30 AM - 6:00 AM | Vulgar Content: ALWAYS BLOCKED</p>
        
        <div class="current-time" id="currentTimeDisplay">
            <strong>Current Amsterdam Time:</strong> <span id="amsterdamTime">Loading...</span>
        </div>
        
        <div class="time-simulator">
            <h3>‚öôÔ∏è Time Simulator (For Testing)</h3>
            <p style="color: #856404; margin-bottom: 15px;">Simulate different Amsterdam times to test the bypass logic:</p>
            <div class="time-input">
                <label>Hour (0-23):</label>
                <input type="number" id="simHour" min="0" max="23" value="4" />
                <label>Minute (0-59):</label>
                <input type="number" id="simMinute" min="0" max="59" value="0" />
                <button onclick="setSimulatedTime()">Set Simulated Time</button>
                <button onclick="clearSimulatedTime()">Use Real Time</button>
            </div>
            <p id="simulatedTimeStatus" style="font-weight: bold; color: #856404;"></p>
        </div>
        
        <button onclick="runAllTests()">‚ñ∂ Run All Tests</button>
        <button onclick="runTimeWindowTests()">üïê Test Time Windows</button>
        <button onclick="runVulgarContentTests()">üö´ Test Vulgar Blocking</button>
        <button onclick="runMovieContentTests()">üé¨ Test Movie Blocking</button>
        <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
        
        <div class="test-section">
            <h2>üïê Time Window Tests</h2>
            <div id="timeWindowTests"></div>
        </div>
        
        <div class="test-section">
            <h2>üö´ Vulgar Content Tests (Always Blocked)</h2>
            <div id="vulgarContentTests"></div>
        </div>
        
        <div class="test-section">
            <h2>üé¨ Movie Content Tests (Allowed 3:30-6:00 AM)</h2>
            <div id="movieContentTests"></div>
        </div>
        
        <div class="summary" id="summary" style="display: none;">
            <h2>üìä Test Summary</h2>
            <div class="summary-stats">
                <div class="stat">
                    <span class="stat-number" id="totalTests">0</span>
                    <span class="stat-label">Total Tests</span>
                </div>
                <div class="stat">
                    <span class="stat-number" id="passedTests" style="color: #4caf50;">0</span>
                    <span class="stat-label">Passed</span>
                </div>
                <div class="stat">
                    <span class="stat-number" id="failedTests" style="color: #f44336;">0</span>
                    <span class="stat-label">Failed</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let simulatedTime = null;
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0
        };
        
        // Get Amsterdam time (real or simulated)
        async function getAmsterdamTime() {
            if (simulatedTime) {
                return simulatedTime;
            }
            
            // Try to get real Amsterdam time
            try {
                const response = await fetch('https://timeapi.io/api/Time/current/zone?timeZone=Europe/Amsterdam');
                const data = await response.json();
                return { hour: data.hour, minute: data.minute };
            } catch {
                // Fallback to browser time converted to Amsterdam
                const now = new Date();
                const amsterdamTime = new Date(now.toLocaleString('en-US', { timeZone: 'Europe/Amsterdam' }));
                return { hour: amsterdamTime.getHours(), minute: amsterdamTime.getMinutes() };
            }
        }
        
        // Check if time is in bypass window
        function isInBypassWindow(hour, minute) {
            const currentMinutes = hour * 60 + minute;
            const startMinutes = 3 * 60 + 30; // 3:30 AM = 210 minutes
            const endMinutes = 6 * 60; // 6:00 AM = 360 minutes
            return currentMinutes >= startMinutes && currentMinutes < endMinutes;
        }
        
        // Update current time display
        async function updateTimeDisplay() {
            const time = await getAmsterdamTime();
            const timeStr = `${time.hour.toString().padStart(2, '0')}:${time.minute.toString().padStart(2, '0')}`;
            const inWindow = isInBypassWindow(time.hour, time.minute);
            document.getElementById('amsterdamTime').textContent = `${timeStr} ${inWindow ? '‚úÖ IN BYPASS WINDOW' : '‚ùå NOT IN BYPASS WINDOW'}`;
        }
        
        // Set simulated time
        function setSimulatedTime() {
            const hour = parseInt(document.getElementById('simHour').value);
            const minute = parseInt(document.getElementById('simMinute').value);
            
            if (hour < 0 || hour > 23 || minute < 0 || minute > 59) {
                alert('Invalid time! Hour must be 0-23, minute must be 0-59.');
                return;
            }
            
            simulatedTime = { hour, minute };
            const timeStr = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
            document.getElementById('simulatedTimeStatus').textContent = `‚è∞ Using simulated time: ${timeStr}`;
            updateTimeDisplay();
        }
        
        // Clear simulated time
        function clearSimulatedTime() {
            simulatedTime = null;
            document.getElementById('simulatedTimeStatus').textContent = '‚úÖ Using real Amsterdam time';
            updateTimeDisplay();
        }
        
        // Check if URL contains vulgar content
        function checkVulgarContent(url) {
            const vulgarKeywords = [
                'porn', 'pornhub', 'xvideos', 'xhamster', 'redtube', 'youporn',
                'fuck', 'shit', 'pussy', 'dick', 'cunt', 'xxx', 'adult', 'sex', 'nude'
            ];
            const urlLower = url.toLowerCase();
            return vulgarKeywords.some(keyword => urlLower.includes(keyword));
        }
        
        // Check if URL contains movie content
        function checkMovieContent(url) {
            const movieKeywords = [
                'netflix', 'movie', 'film', 'hulu', 'disney', 'hbo', 
                '123movies', 'putlocker', 'fmovies', 'cinema'
            ];
            const urlLower = url.toLowerCase();
            return movieKeywords.some(keyword => urlLower.includes(keyword));
        }
        
        // Create test case HTML
        function createTestCase(name, status, details, url = '') {
            const statusBadge = `<span class="status-badge ${status}">${status.toUpperCase()}</span>`;
            const urlHtml = url ? `<div class="test-url">üîó ${url}</div>` : '';
            
            return `
                <div class="test-case ${status}">
                    <div class="test-name">${name} ${statusBadge}</div>
                    ${urlHtml}
                    <div class="test-result">${details}</div>
                </div>
            `;
        }
        
        // Run time window tests
        async function runTimeWindowTests() {
            const container = document.getElementById('timeWindowTests');
            container.innerHTML = '<p>Running tests...</p>';
            
            const tests = [
                { hour: 3, minute: 29, expected: false, name: '3:29 AM (Before window)' },
                { hour: 3, minute: 30, expected: true, name: '3:30 AM (Start of window)' },
                { hour: 4, minute: 0, expected: true, name: '4:00 AM (Inside window)' },
                { hour: 5, minute: 30, expected: true, name: '5:30 AM (Inside window)' },
                { hour: 5, minute: 59, expected: true, name: '5:59 AM (End of window)' },
                { hour: 6, minute: 0, expected: false, name: '6:00 AM (After window)' },
                { hour: 12, minute: 0, expected: false, name: '12:00 PM (Outside window)' },
                { hour: 23, minute: 59, expected: false, name: '11:59 PM (Outside window)' }
            ];
            
            let html = '';
            tests.forEach(test => {
                const result = isInBypassWindow(test.hour, test.minute);
                const pass = result === test.expected;
                const timeStr = `${test.hour.toString().padStart(2, '0')}:${test.minute.toString().padStart(2, '0')}`;
                
                if (pass) {
                    testResults.passed++;
                    html += createTestCase(
                        test.name,
                        'pass',
                        `‚úÖ Correct: Time ${timeStr} is ${result ? 'IN' : 'NOT IN'} bypass window as expected.`
                    );
                } else {
                    testResults.failed++;
                    html += createTestCase(
                        test.name,
                        'fail',
                        `‚ùå Failed: Expected ${test.expected ? 'IN' : 'NOT IN'} bypass window, but got ${result ? 'IN' : 'NOT IN'}.`
                    );
                }
                testResults.total++;
            });
            
            container.innerHTML = html;
            updateSummary();
        }
        
        // Run vulgar content tests
        async function runVulgarContentTests() {
            const container = document.getElementById('vulgarContentTests');
            container.innerHTML = '<p>Running tests...</p>';
            
            const testUrls = [
                { url: 'https://pornhub.com', expected: true, name: 'Pornhub URL' },
                { url: 'https://xvideos.com/video', expected: true, name: 'Xvideos URL' },
                { url: 'https://example.com/xxx-content', expected: true, name: 'URL with XXX' },
                { url: 'https://youtube.com/watch?v=123', expected: false, name: 'YouTube (not vulgar)' },
                { url: 'https://netflix.com/movie', expected: false, name: 'Netflix (not vulgar)' },
                { url: 'https://stackoverflow.com', expected: false, name: 'StackOverflow (clean)' }
            ];
            
            const time = await getAmsterdamTime();
            const inBypassWindow = isInBypassWindow(time.hour, time.minute);
            
            let html = '';
            testUrls.forEach(test => {
                const hasVulgar = checkVulgarContent(test.url);
                const shouldBlock = hasVulgar; // Always block vulgar content
                const pass = hasVulgar === test.expected;
                
                if (pass) {
                    testResults.passed++;
                    html += createTestCase(
                        test.name,
                        'pass',
                        `‚úÖ Correct: URL ${hasVulgar ? 'contains vulgar content and WILL BE BLOCKED' : 'is clean and will be allowed'} (bypass window: ${inBypassWindow ? 'YES' : 'NO'})`,
                        test.url
                    );
                } else {
                    testResults.failed++;
                    html += createTestCase(
                        test.name,
                        'fail',
                        `‚ùå Failed: Expected ${test.expected ? 'VULGAR' : 'CLEAN'}, detected as ${hasVulgar ? 'VULGAR' : 'CLEAN'}`,
                        test.url
                    );
                }
                testResults.total++;
            });
            
            container.innerHTML = html;
            updateSummary();
        }
        
        // Run movie content tests
        async function runMovieContentTests() {
            const container = document.getElementById('movieContentTests');
            container.innerHTML = '<p>Running tests...</p>';
            
            const testUrls = [
                { url: 'https://netflix.com/watch/12345', expected: true, name: 'Netflix URL' },
                { url: 'https://123movies.com/movie', expected: true, name: '123movies URL' },
                { url: 'https://youtube.com/watch?v=movie', expected: true, name: 'YouTube movie' },
                { url: 'https://hulu.com/series/12345', expected: true, name: 'Hulu URL' },
                { url: 'https://github.com/project', expected: false, name: 'GitHub (not movie)' },
                { url: 'https://stackoverflow.com/questions', expected: false, name: 'StackOverflow (not movie)' }
            ];
            
            const time = await getAmsterdamTime();
            const inBypassWindow = isInBypassWindow(time.hour, time.minute);
            
            let html = '';
            testUrls.forEach(test => {
                const hasMovie = checkMovieContent(test.url);
                const wouldBeBlocked = hasMovie && !inBypassWindow;
                const pass = hasMovie === test.expected;
                
                if (pass) {
                    testResults.passed++;
                    const blockStatus = inBypassWindow 
                        ? (hasMovie ? '‚úÖ ALLOWED (in bypass window)' : '‚úÖ ALLOWED (not movie content)')
                        : (hasMovie ? 'üö´ BLOCKED (outside bypass window)' : '‚úÖ ALLOWED (not movie content)');
                    
                    html += createTestCase(
                        test.name,
                        'pass',
                        `‚úÖ Correct: URL ${hasMovie ? 'contains movie content' : 'is not movie content'} - Status: ${blockStatus}`,
                        test.url
                    );
                } else {
                    testResults.failed++;
                    html += createTestCase(
                        test.name,
                        'fail',
                        `‚ùå Failed: Expected ${test.expected ? 'MOVIE CONTENT' : 'NOT MOVIE CONTENT'}, detected as ${hasMovie ? 'MOVIE CONTENT' : 'NOT MOVIE CONTENT'}`,
                        test.url
                    );
                }
                testResults.total++;
            });
            
            container.innerHTML = html;
            updateSummary();
        }
        
        // Run all tests
        async function runAllTests() {
            clearResults();
            await runTimeWindowTests();
            await runVulgarContentTests();
            await runMovieContentTests();
        }
        
        // Clear results
        function clearResults() {
            testResults = { total: 0, passed: 0, failed: 0 };
            document.getElementById('timeWindowTests').innerHTML = '';
            document.getElementById('vulgarContentTests').innerHTML = '';
            document.getElementById('movieContentTests').innerHTML = '';
            document.getElementById('summary').style.display = 'none';
        }
        
        // Update summary
        function updateSummary() {
            document.getElementById('summary').style.display = 'block';
            document.getElementById('totalTests').textContent = testResults.total;
            document.getElementById('passedTests').textContent = testResults.passed;
            document.getElementById('failedTests').textContent = testResults.failed;
        }
        
        // Initialize
        updateTimeDisplay();
        setInterval(updateTimeDisplay, 30000); // Update every 30 seconds
        clearSimulatedTime();
    </script>
</body>
</html>
